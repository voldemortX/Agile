(function(t){function e(e){for(var l,s,n=e[0],o=e[1],u=e[2],d=0,h=[];d<n.length;d++)s=n[d],i[s]&&h.push(i[s][0]),i[s]=0;for(l in o)Object.prototype.hasOwnProperty.call(o,l)&&(t[l]=o[l]);c&&c(e);while(h.length)h.shift()();return r.push.apply(r,u||[]),a()}function a(){for(var t,e=0;e<r.length;e++){for(var a=r[e],l=!0,n=1;n<a.length;n++){var o=a[n];0!==i[o]&&(l=!1)}l&&(r.splice(e--,1),t=s(s.s=a[0]))}return t}var l={},i={app:0},r=[];function s(e){if(l[e])return l[e].exports;var a=l[e]={i:e,l:!1,exports:{}};return t[e].call(a.exports,a,a.exports,s),a.l=!0,a.exports}s.m=t,s.c=l,s.d=function(t,e,a){s.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},s.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(t,e){if(1&e&&(t=s(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(s.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var l in t)s.d(a,l,function(e){return t[e]}.bind(null,l));return a},s.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="/";var n=window["webpackJsonp"]=window["webpackJsonp"]||[],o=n.push.bind(n);n.push=e,n=n.slice();for(var u=0;u<n.length;u++)e(n[u]);var c=o;r.push([0,"chunk-vendors"]),a()})({0:function(t,e,a){t.exports=a("56d7")},"034f":function(t,e,a){"use strict";var l=a("64a9"),i=a.n(l);i.a},"0f1a":function(t,e,a){"use strict";var l=a("4d5d"),i=a.n(l);i.a},1:function(t,e){},2060:function(t,e,a){"use strict";var l=a("8516"),i=a.n(l);i.a},"26ca":function(t,e,a){"use strict";var l=a("be89"),i=a.n(l);i.a},"2aaf":function(t,e,a){},"4d5d":function(t,e,a){},"56d7":function(t,e,a){"use strict";a.r(e);a("cadf"),a("551c"),a("f751"),a("097d");var l=a("2b0e"),i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"bg-global",attrs:{id:"app"}},[a("router-view")],1)},r=[],s=(a("034f"),a("2877")),n={},o=Object(s["a"])(n,i,r,!1,null,null,null),u=o.exports,c=a("5c96"),d=a.n(c);a("0fae");l["default"].use(d.a);var h=a("8c4f"),f=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"top-align"},[a("h1",[t._v("风险评估系统")]),a("el-row",[a("el-col",{attrs:{span:10}},[a("div",{staticClass:"grid-content"})]),a("el-col",{attrs:{span:4}},[a("div",{staticClass:"bg-light"},[a("el-row",[a("div",{staticClass:"grid-content bg-dark"})]),a("el-form",{attrs:{"label-position":t.labelPosition}},[a("el-form-item",[a("el-input",{attrs:{name:"username","prefix-icon":"el-icon-arrow-right",size:"medium",placeholder:"用户名"},model:{value:t.username,callback:function(e){t.username=e},expression:"username"}})],1),a("el-form-item",[a("el-input",{attrs:{name:"password","prefix-icon":"el-icon-arrow-right",size:"medium",type:"password",placeholder:"密码"},model:{value:t.password,callback:function(e){t.password=e},expression:"password"}})],1),a("el-form-item",[a("el-button",{attrs:{name:"login",type:"primary",round:""},nativeOn:{click:function(e){return t.login_click(e)}}},[t._v("登录")]),a("el-button",{attrs:{name:"register",round:"",plain:""},nativeOn:{click:function(e){return t.register_click(e)}}},[t._v("注册")]),a("p",{staticClass:"error"},[t._v(t._s(t.errorMessage))])],1)],1)],1)]),a("el-col",{attrs:{span:10}},[a("div",{staticClass:"grid-content"})])],1)],1)},m=[],b=a("f499"),p=a.n(b),v={name:"login",data:function(){return{labelPosition:"right",username:"",password:"",errorMessage:""}},methods:{dump:function(){this.username="",this.password=""},register_click:function(){var t=this;this.$http({method:"POST",url:"/auth/register",emulateJSON:!0,body:p()({username:this.username,password:this.password})}).then(function(e){e.ok&&0===e.body.status?t.errorMessage="注册成功！":t.errorMessage=e.body.error},function(e){t.errorMessage=e.body.error})},login_click:function(){var t=this;this.$http({method:"POST",url:"/auth/login",emulateJSON:!0,body:p()({username:this.username,password:this.password})}).then(function(e){e.ok&&0===e.body.status?t.$router.push({path:"/mainPage"}):t.errorMessage=e.body.error},function(e){t.errorMessage=e.body.error})}}},y=v,g=(a("570d"),Object(s["a"])(y,f,m,!1,null,"d4416164",null)),x=g.exports,k=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("el-container",[a("el-header",{staticStyle:{"text-align":"center","vertical-align":"middle","font-size":"40px",height:"100px"}},[a("el-row"),a("span",[t._v("风险评估系统")])],1),a("el-main",{staticStyle:{"text-align":"center","background-color":"#000000"}},[a("el-button",{attrs:{type:"primary"},on:{click:function(e){t.dialogFormVisible=!0}}},[t._v("新建 +")])],1)],1),a("el-container",[a("el-header",{staticStyle:{"text-align":"center","font-size":"24px","background-color":"#DCDCDC",color:"#000000",height:"70px"}},[a("span",[t._v("已评估系统")])]),a("el-main",[a("el-table",{attrs:{data:t.tableSys,border:"","header-cell-style":{background:"#FFFFFF"},"cell-style":{background:"#FFFFFF"}}},[a("el-table-column",{attrs:{prop:"systemname",label:"SystemID",width:"250"}}),a("el-table-column",{attrs:{prop:"method",label:"Method",width:"140"}}),a("el-table-column",{attrs:{prop:"results",label:"Result",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{staticStyle:{"font-size":"14px",width:"38px",height:"20px"},attrs:{type:"text",size:"small"},nativeOn:{click:function(a){return t.result(e.$index)}}},[t._v("查看详情")])]}}])}),a("el-table-column",{attrs:{prop:"createtime",label:"CreateTime",width:"200"}}),a("el-table-column",{attrs:{prop:"description",label:"Description"}}),a("el-table-column",{attrs:{fixed:"right",label:"操作",width:"180"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{staticStyle:{"font-size":"16px",width:"38px",height:"20px"},attrs:{type:"text",size:"small"},nativeOn:{click:function(a){return t.ModifyClick(e.row)}}},[t._v("修改")]),a("el-button",{staticStyle:{"font-size":"16px",width:"38px",height:"20px"},attrs:{type:"text",size:"small"},nativeOn:{click:function(a){return t.DelClick(e.$index,e.row)}}},[t._v("删除")])]}}])})],1)],1)],1),a("el-dialog",{attrs:{title:"评估结果",visible:t.resultDialogVisible,"modal-append-to-body":!1},on:{"update:visible":function(e){t.resultDialogVisible=e}}},[a("el-table",{attrs:{data:t.assessresults,border:"","header-cell-style":{background:"#FFFFFF"},"cell-style":{background:"#FFFFFF"}}},[a("el-table-column",{attrs:{prop:"asset",label:"资产名称",width:"140"}}),a("el-table-column",{attrs:{prop:"threat",label:"威胁名称",width:"140"}}),a("el-table-column",{attrs:{prop:"vulnerability",label:"脆弱性名称",width:"140"}}),a("el-table-column",{attrs:{prop:"level",label:"风险等级",width:"140"}})],1)],1),a("el-dialog",{attrs:{title:"输入系统名称",visible:t.dialogFormVisible,"modal-append-to-body":!1},on:{"update:visible":function(e){t.dialogFormVisible=e}}},[a("el-form",{attrs:{model:t.newsys}},[a("el-form-item",{attrs:{label:"系统名称","label-width":t.formLabelWidth}},[a("el-input",{attrs:{"auto-complete":"off"},model:{value:t.newsys.name,callback:function(e){t.$set(t.newsys,"name",e)},expression:"newsys.name"}})],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{staticStyle:{"font-size":"16px",width:"75px",height:"40px"},on:{click:function(e){t.dialogFormVisible=!1}}},[t._v("取 消")]),a("el-button",{staticStyle:{"font-size":"16px",width:"75px",height:"40px"},attrs:{type:"primary"},nativeOn:{click:function(e){return t.getnew()}}},[t._v("确 定")])],1)],1)],1)},w=[],_=(a("a481"),a("7f7f"),a("ac6a"),{name:"mainPage",methods:{ModifyClick:function(t){this.$router.push({name:"new",query:{sysname:t.systemname}})},DelClick:function(t,e){var a=this;this.$http({method:"DELETE",url:"/sys/delete",params:{systemname:e.systemname}}).then(function(e){e.ok&&0===e.body.status?a.tableSys.splice(t,1):a.errorMessage=e.body.error},function(t){a.errorMessage=t.body.error})},result:function(t){var e=this;this.assessresults.forEach(function(t){e.assessresults.splice(t,e.assessresults.length)});for(var a=0;a<this.tempresults[t].length;a++)this.assessresults.push(this.tempresults[t][a]);this.resultDialogVisible=!0},getnew:function(){this.$router.push({name:"new",query:{sysname:this.newsys.name}})}},data:function(){return{tableSys:[],resultDialogVisible:!1,dialogFormVisible:!1,newsys:{name:""},assessresults:[],tempresults:[]}},mounted:function(){var t=this;this.$http.get("/sys/fetch_all").then(function(e){if(e.ok&&0===e.body.status){for(var a=0;a<e.body.systems.length;a++){var l={};l.systemname=e.body.systems[a].systemname,l.method=e.body.systems[a].method,l.createtime=e.body.systems[a].createtime,l.description=e.body.systems[a].description.replace("&&&","; ").replace("&&&","; ").replace("&&&",""),t.tableSys.push(l)}for(var i=0;i<e.body.systems.length;i++)t.tempresults.push(e.body.systems[i].results.tva_results)}else t.errorMessage=e.body.error},function(e){t.errorMessage=e.body.error})}}),V=_,F=(a("26ca"),a("2060"),Object(s["a"])(V,k,w,!1,null,"5ad0d9ec",null)),T=F.exports,A=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("el-container",{attrs:{width:"200px"}},[a("el-header",{staticStyle:{"text-align":"center","vertical-align":"middle","font-size":"40px",height:"100px"}},[a("el-row"),a("span",[t._v(t._s(t.systemname))])],1),a("el-main",{staticStyle:{"text-align":"center","background-color":"#000000"}},[a("el-row",[a("el-radio-group",{model:{value:t.method,callback:function(e){t.method=e},expression:"method"}},[a("el-radio",{attrs:{label:0}},[t._v("相乘法")]),a("el-radio",{attrs:{label:1}},[t._v("矩阵法")])],1)],1),a("el-row",[a("el-button",{attrs:{name:"calc",type:"primary"},nativeOn:{click:function(e){return t.calcClick(e)}}},[t._v("提交")])],1)],1),a("el-main",{staticStyle:{"text-align":"center"}},[a("el-tabs",{nativeOn:{"tab-click":function(e){return t.handleClick(e)}},model:{value:t.activeName,callback:function(e){t.activeName=e},expression:"activeName"}},[a("el-tab-pane",{attrs:{label:"评估准备",name:"first"}},[a("el-divider",{attrs:{"content-position":"left"}},[t._v("评估目标")]),a("el-input",{attrs:{type:"textarea",rows:5,placeholder:"请输入内容"},model:{value:t.aim,callback:function(e){t.aim=e},expression:"aim"}}),a("el-divider",{attrs:{"content-position":"left"}},[t._v("评估范围")]),a("el-input",{attrs:{type:"textarea",rows:5,placeholder:"请输入内容"},model:{value:t.range,callback:function(e){t.range=e},expression:"range"}}),a("el-divider",{attrs:{"content-position":"left"}},[t._v("组建团队成员")]),a("el-input",{attrs:{type:"textarea",rows:5,placeholder:"请输入内容"},model:{value:t.team,callback:function(e){t.team=e},expression:"team"}})],1),a("el-tab-pane",{attrs:{label:"资产评估",name:"second"}},[a("div",{staticStyle:{float:"left"}},[a("el-button",{attrs:{type:"add"},nativeOn:{click:function(e){t.assetDialogVisible=!0}}},[t._v("添加")])],1),a("el-table",{attrs:{data:t.tableAsset,border:"","header-cell-style":{background:"#FFFFFF"},"cell-style":{background:"#FFFFFF"}}},[a("el-table-column",{attrs:{prop:"asset",label:"资产名称",width:"260"}}),a("el-table-column",{attrs:{prop:"integrity",label:"完整性",width:"140"}}),a("el-table-column",{attrs:{prop:"availability",label:"可用性",width:"140"}}),a("el-table-column",{attrs:{prop:"confidentiality",label:"保密性",width:"140"}}),a("el-table-column",{attrs:{prop:"rank",label:"资产价值",width:"140"}}),a("el-table-column",{attrs:{prop:"details",label:"描述"}}),a("el-table-column",{attrs:{fixed:"right",label:"操作",width:"180"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{staticStyle:{"font-size":"16px",width:"38px",height:"20px"},attrs:{type:"text",size:"small"},nativeOn:{click:function(a){return t.formAssetModify(e.$index)}}},[t._v("修改")]),a("el-button",{staticStyle:{"font-size":"16px",width:"38px",height:"20px"},attrs:{type:"text",size:"small"},nativeOn:{click:function(a){return t.formDelete(e.$index,t.tableAsset)}}},[t._v("删除")])]}}])})],1)],1),a("el-tab-pane",{attrs:{label:"脆弱性评估",name:"third"}},[a("div",{staticStyle:{float:"left"}},[a("el-button",{attrs:{type:"add"},nativeOn:{click:function(e){t.vulDialogVisible=!0}}},[t._v("添加")])],1),a("el-table",{attrs:{data:t.tableVul,border:"","header-cell-style":{background:"#FFFFFF"},"cell-style":{background:"#FFFFFF"}}},[a("el-table-column",{attrs:{prop:"vulnerability",label:"脆弱性名称",width:"260"}}),a("el-table-column",{attrs:{prop:"rank",label:"脆弱性等级",width:"140"}}),a("el-table-column",{attrs:{prop:"vaString",label:"资产关联",width:"140"}}),a("el-table-column",{attrs:{prop:"details",label:"描述"}}),a("el-table-column",{attrs:{fixed:"right",label:"操作",width:"180"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{staticStyle:{"font-size":"16px",width:"38px",height:"20px"},attrs:{type:"text",size:"small"},nativeOn:{click:function(a){return t.formVulModify(e.$index)}}},[t._v("修改")]),a("el-button",{staticStyle:{"font-size":"16px",width:"38px",height:"20px"},attrs:{type:"text",size:"small"},nativeOn:{click:function(a){return t.formDelete(e.$index,t.tableVul)}}},[t._v("删除")])]}}])})],1)],1),a("el-tab-pane",{attrs:{label:"威胁评估",name:"fourth"}},[a("div",{staticStyle:{float:"left"}},[a("el-button",{attrs:{type:"add"},nativeOn:{click:function(e){t.threatDialogVisible=!0}}},[t._v("添加")])],1),a("el-table",{attrs:{data:t.tableThreat,border:"","header-cell-style":{background:"#FFFFFF"},"cell-style":{background:"#FFFFFF"}}},[a("el-table-column",{attrs:{prop:"threat",label:"威胁名称",width:"260"}}),a("el-table-column",{attrs:{prop:"rank",label:"威胁等级",width:"140"}}),a("el-table-column",{attrs:{prop:"tvString",label:"威胁的脆弱性关联",width:"140"}}),a("el-table-column",{attrs:{prop:"details",label:"描述"}})],1)],1)],1)],1)],1),a("el-dialog",{attrs:{title:"添加资产",visible:t.assetDialogVisible,"modal-append-to-body":!1,"show-close":!1},on:{"update:visible":function(e){t.assetDialogVisible=e}}},[a("el-form",{attrs:{model:t.formAsset}},[a("el-form-item",{attrs:{label:"资产名称","label-width":t.formLabelWidth}},[a("el-input",{attrs:{autocomplete:"off",width:"200px"},model:{value:t.formAsset.name,callback:function(e){t.$set(t.formAsset,"name",e)},expression:"formAsset.name"}})],1),a("el-form-item",{attrs:{label:"保密性","label-width":t.formLabelWidth}},[a("el-select",{attrs:{placeholder:"请选择安全等级"},model:{value:t.formAsset.confidentiality,callback:function(e){t.$set(t.formAsset,"confidentiality",e)},expression:"formAsset.confidentiality"}},[a("el-option",{attrs:{label:"很高",value:"5"}}),a("el-option",{attrs:{label:"高",value:"4"}}),a("el-option",{attrs:{label:"中",value:"3"}}),a("el-option",{attrs:{label:"低",value:"2"}}),a("el-option",{attrs:{label:"很低",value:"1"}})],1)],1),a("el-form-item",{attrs:{label:"完整性","label-width":t.formLabelWidth}},[a("el-select",{attrs:{placeholder:"请选择安全等级"},model:{value:t.formAsset.integrity,callback:function(e){t.$set(t.formAsset,"integrity",e)},expression:"formAsset.integrity"}},[a("el-option",{attrs:{label:"很高",value:"5"}}),a("el-option",{attrs:{label:"高",value:"4"}}),a("el-option",{attrs:{label:"中",value:"3"}}),a("el-option",{attrs:{label:"低",value:"2"}}),a("el-option",{attrs:{label:"很低",value:"1"}})],1)],1),a("el-form-item",{attrs:{label:"可用性","label-width":t.formLabelWidth}},[a("el-select",{attrs:{placeholder:"请选择安全等级"},model:{value:t.formAsset.availability,callback:function(e){t.$set(t.formAsset,"availability",e)},expression:"formAsset.availability"}},[a("el-option",{attrs:{label:"很高",value:"5"}}),a("el-option",{attrs:{label:"高",value:"4"}}),a("el-option",{attrs:{label:"中",value:"3"}}),a("el-option",{attrs:{label:"低",value:"2"}}),a("el-option",{attrs:{label:"很低",value:"1"}})],1)],1),a("el-form-item",[a("el-input",{attrs:{type:"textarea",rows:5,placeholder:"请输入资产描述"},model:{value:t.formAsset.details,callback:function(e){t.$set(t.formAsset,"details",e)},expression:"formAsset.details"}})],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{nativeOn:{click:function(e){return t.dialogAssetClose(e)}}},[t._v("取 消")]),a("el-button",{attrs:{type:"primary"},nativeOn:{click:function(e){return t.formAssertClick(e)}}},[t._v("确 定")])],1)],1),a("el-dialog",{attrs:{title:"添加脆弱性",visible:t.vulDialogVisible,"modal-append-to-body":!1,"show-close":!1},on:{"update:visible":function(e){t.vulDialogVisible=e}}},[a("el-form",{attrs:{model:t.formVul}},[a("el-form-item",{attrs:{label:"脆弱性名称","label-width":t.formLabelWidth}},[a("el-input",{attrs:{autocomplete:"off",width:"200px"},model:{value:t.formVul.name,callback:function(e){t.$set(t.formVul,"name",e)},expression:"formVul.name"}})],1),a("el-form-item",{attrs:{label:"脆弱性等级","label-width":t.formLabelWidth}},[a("el-select",{attrs:{placeholder:"请选择等级"},model:{value:t.formVul.rank,callback:function(e){t.$set(t.formVul,"rank",e)},expression:"formVul.rank"}},[a("el-option",{attrs:{label:"很高",value:"5"}}),a("el-option",{attrs:{label:"高",value:"4"}}),a("el-option",{attrs:{label:"中",value:"3"}}),a("el-option",{attrs:{label:"低",value:"2"}}),a("el-option",{attrs:{label:"很低",value:"1"}})],1)],1),a("el-form-item",{attrs:{label:"关联已有资产","label-width":t.formLabelWidth}},[a("el-checkbox-group",{model:{value:t.formVul.va,callback:function(e){t.$set(t.formVul,"va",e)},expression:"formVul.va"}},t._l(t.tableAsset,function(e){return a("el-checkbox",{key:e.asset,attrs:{label:e.asset}},[t._v(t._s(e.asset))])}),1)],1),a("el-form-item",[a("el-input",{attrs:{type:"textarea",rows:5,placeholder:"请输入脆弱性描述"},model:{value:t.formVul.details,callback:function(e){t.$set(t.formVul,"details",e)},expression:"formVul.details"}})],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{nativeOn:{click:function(e){return t.dialogVulClose(e)}}},[t._v("取 消")]),a("el-button",{attrs:{type:"primary"},nativeOn:{click:function(e){return t.formVulClick(e)}}},[t._v("确 定")])],1)],1),a("el-dialog",{attrs:{title:"添加威胁",visible:t.threatDialogVisible,"modal-append-to-body":!1,"show-close":!1},on:{"update:visible":function(e){t.threatDialogVisible=e}}},[a("el-form",{attrs:{model:t.formThreat}},[a("el-form-item",{attrs:{label:"威胁名称","label-width":t.formLabelWidth}},[a("el-input",{attrs:{autocomplete:"off",width:"200px"},model:{value:t.formThreat.name,callback:function(e){t.$set(t.formThreat,"name",e)},expression:"formThreat.name"}})],1),a("el-form-item",{attrs:{label:"威胁等级","label-width":t.formLabelWidth}},[a("el-select",{attrs:{placeholder:"请选择等级"},model:{value:t.formThreat.rank,callback:function(e){t.$set(t.formThreat,"rank",e)},expression:"formThreat.rank"}},[a("el-option",{attrs:{label:"很高",value:"5"}}),a("el-option",{attrs:{label:"高",value:"4"}}),a("el-option",{attrs:{label:"中",value:"3"}}),a("el-option",{attrs:{label:"低",value:"2"}}),a("el-option",{attrs:{label:"很低",value:"1"}})],1)],1),a("el-form-item",{attrs:{label:"关联已有脆弱性","label-width":t.formLabelWidth}},[a("el-checkbox-group",{model:{value:t.formThreat.tv,callback:function(e){t.$set(t.formThreat,"tv",e)},expression:"formThreat.tv"}},t._l(t.tableVul,function(e){return a("el-checkbox",{key:e.vulnerability,attrs:{label:e.vulnerability}},[t._v(t._s(e.vulnerability))])}),1)],1),a("el-form-item",[a("el-input",{attrs:{type:"textarea",rows:5,placeholder:"请输入脆弱性描述"},model:{value:t.formThreat.details,callback:function(e){t.$set(t.formThreat,"details",e)},expression:"formThreat.details"}})],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{nativeOn:{click:function(e){return t.dialogThreatClose(e)}}},[t._v("取 消")]),a("el-button",{attrs:{type:"primary"},nativeOn:{click:function(e){return t.formThreatClick(e)}}},[t._v("确 定")])],1)],1),a("el-dialog",{attrs:{title:"评估结果",visible:t.resultDialogVisible,"modal-append-to-body":!1},on:{"update:visible":function(e){t.resultDialogVisible=e}}},[a("div",{staticClass:"el-dialog__header",attrs:{slot:"title"},slot:"title"},[a("h2",[t._v("评估结果")]),a("el-button",{attrs:{type:"primary"},nativeOn:{click:function(e){return t.createWord(e)}}},[t._v("导出")]),a("el-button",{attrs:{type:"primary"},nativeOn:{click:function(e){return t.createHist(e)}}},[t._v("作图")])],1),a("el-table",{attrs:{data:t.tva_results,border:"","header-cell-style":{background:"#FFFFFF"},"cell-style":{background:"#FFFFFF"}}},[a("el-table-column",{attrs:{prop:"asset",label:"资产名称",width:"160"}}),a("el-table-column",{attrs:{prop:"threat",label:"威胁名称",width:"160"}}),a("el-table-column",{attrs:{prop:"vulnerability",label:"脆弱性名称",width:"160"}}),a("el-table-column",{attrs:{prop:"level",label:"风险等级"}})],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{nativeOn:{click:function(e){t.resultDialogVisible=!1}}},[t._v("取 消")]),a("el-button",{attrs:{type:"primary"},nativeOn:{click:function(e){return t.submitClick(e)}}},[t._v("确 定")])],1)],1),a("el-dialog",{attrs:{visible:t.chartDialogVisible,"modal-append-to-body":!1,width:"60%"},on:{"update:visible":function(e){t.chartDialogVisible=e}}},[a("div",{staticStyle:{width:"1200px",height:"400px"},attrs:{id:"chart"}})])],1)},O=[],S=(a("6b54"),a("28a5"),a("5d73")),C=a.n(S),D=[[1,1,2,2,3],[1,1,2,3,4],[1,2,3,3,4],[1,2,3,3,5],[2,2,4,5,5]],$=[[1,1,2,2,3],[1,2,2,3,4],[1,2,3,3,4],[2,2,3,4,5],[2,3,4,4,5]],P=[[1,1,2,2,3],[1,2,2,3,3],[1,2,3,3,4],[2,2,3,4,4],[2,3,4,4,5]],M=["很低","低","中","高","很高"],z=["相乘法","矩阵法"],R={name:"_new",data:function(){return{activeName:"first",formLabelWidth:"120px",assetDialogVisible:!1,threatDialogVisible:!1,vulDialogVisible:!1,resultDialogVisible:!1,chartDialogVisible:!1,aim:"",range:"",team:"",tableAsset:[],tableVul:[],tableThreat:[],formAsset:{name:"",availability:null,integrity:null,confidentiality:null,details:""},formThreat:{name:"",rank:null,tv:[],details:""},formVul:{name:"",rank:null,va:[],details:""},systemname:"test1",method:0,tva_results:[]}},created:function(){var t=this;this.systemname=this.$route.query.sysname,this.$http({method:"GET",url:"/sys/query",params:{systemname:this.systemname}}).then(function(e){e.ok&&0===e.body.status?t.loadData(e.body):"该系统不存在"!==e.body.error&&t.messageBox("错误",e.body.error)},function(e){t.messageBox("错误",e.body.error)})},methods:{loadData:function(t){this.method=z.indexOf(t.method),this.tva_results=t.results.tva_results;var e=!0,a=!1,l=void 0;try{for(var i,r=C()(t.assets);!(e=(i=r.next()).done);e=!0){var s=i.value,n=s.description.split("&&&"),o={asset:s.assetname,confidentiality:n[1],integrity:n[2],availability:n[3],details:n[0],rank:M[s.val-1]};this.tableAsset.push(o)}}catch(A){a=!0,l=A}finally{try{e||null==r.return||r.return()}finally{if(a)throw l}}var u=!0,c=!1,d=void 0;try{for(var h,f=C()(t.vulnerabilities);!(u=(h=f.next()).done);u=!0){var m=h.value,b=t.results.va_results[m.vulname],p={vulnerability:m.vulname,rank:M[m.val-1],details:m.description,va:b,vaString:b.toString()};this.tableVul.push(p)}}catch(A){c=!0,d=A}finally{try{u||null==f.return||f.return()}finally{if(c)throw d}}var v=!0,y=!1,g=void 0;try{for(var x,k=C()(t.threats);!(v=(x=k.next()).done);v=!0){var w=x.value,_=t.results.tv_results[w.threatname],V={threat:w.threatname,rank:M[w.val-1],details:w.description,tv:_,tvString:_.toString()};this.tableThreat.push(V)}}catch(A){y=!0,g=A}finally{try{v||null==k.return||k.return()}finally{if(y)throw g}}var F=t.description,T=F.indexOf("&&&范围：");this.aim=F.substr(3,T-3),F=F.substr(T+6,F.length-T-6),T=F.indexOf("&&&成员："),this.range=F.substr(0,T),F=F.substr(T+6,F.length-T-6),T=F.indexOf("&&&"),this.team=F.substr(0,T)},levelMultiply:function(t){return Math.ceil((t-1)/5)},messageBox:function(t,e){this.$alert(e,t,{confirmButtonText:"确定"})},handleClick:function(t,e){console.log(t,e)},dialogAssetClose:function(){this.formAsset={name:"",availability:null,integrity:null,confidentiality:null,details:""},this.assetDialogVisible=!1},dialogVulClose:function(){this.formVul={name:"",rank:null,va:[],details:""},this.vulDialogVisible=!1},dialogThreatClose:function(){this.formThreat={name:"",rank:null,tv:[],details:""},this.threatDialogVisible=!1},formAssertClick:function(){if(""===this.formAsset.name||null===this.formAsset.confidentiality||null===this.formAsset.integrity||null===this.formAsset.availability)this.messageBox("错误提示","请完整填写必要信息！");else{var t=this.formAsset.availability;this.formAsset.integrity>t&&(t=this.formAsset.integrity),this.formAsset.confidentiality>t&&(t=this.formAsset.confidentiality);for(var e={asset:this.formAsset.name,confidentiality:M[this.formAsset.confidentiality-1],integrity:M[this.formAsset.integrity-1],availability:M[this.formAsset.availability-1],details:this.formAsset.details,rank:M[t-1]},a=0;a<this.tableAsset.length;++a)this.tableAsset[a].asset===e.asset&&this.tableAsset.splice(a,1);this.tableAsset.push(e),this.dialogAssetClose()}},formThreatClick:function(){if(""===this.formThreat.name||null===this.formThreat.rank)this.messageBox("错误提示","请完整填写必要信息！");else{for(var t={threat:this.formThreat.name,tv:this.formThreat.tv,tvString:this.formThreat.tv.toString(),details:this.formThreat.details,rank:M[this.formThreat.rank-1]},e=0;e<this.tableThreat.length;++e)this.tableThreat[e].threat===t.threat&&this.tableThreat.splice(e,1);this.tableThreat.push(t),this.dialogThreatClose()}},formVulClick:function(){if(""===this.formVul.name||null===this.formVul.rank)this.messageBox("错误提示","请完整填写必要信息！");else{for(var t={vulnerability:this.formVul.name,va:this.formVul.va,vaString:this.formVul.va.toString(),details:this.formVul.details,rank:M[this.formVul.rank-1]},e=0;e<this.tableVul.length;++e)this.tableVul[e].vulnerability===t.vulnerability&&this.tableVul.splice(e,1);this.tableVul.push(t),this.dialogVulClose()}},formAssetModify:function(t){this.formAsset.name=this.tableAsset[t].asset,this.formAsset.details=this.tableAsset[t].details,this.formAsset.confidentiality=String(M.indexOf(this.tableAsset[t].confidentiality)+1),this.formAsset.integrity=String(M.indexOf(this.tableAsset[t].integrity)+1),this.formAsset.availability=String(M.indexOf(this.tableAsset[t].availability)+1),this.assetDialogVisible=!0},formVulModify:function(t){this.formVul.name=this.tableVul[t].vulnerability,this.formVul.details=this.tableVul[t].details,this.formVul.rank=String(M.indexOf(this.tableVul[t].rank)+1),this.formVul.va=this.tableVul[t].va,this.vulDialogVisible=!0},formThreatModify:function(t){this.formThreat.name=this.tableThreat[t].threat,this.formThreat.details=this.tableThreat[t].details,this.formThreat.rank=String(M.indexOf(this.tableThreat[t].rank)+1),this.formThreat.tv=this.tableThreat[t].tv,this.threatDialogVisible=!0},formDelete:function(t,e){e.splice(t,1)},calcClick:function(){this.tva_results=[];var t=!0,e=!1,a=void 0;try{for(var l,i=C()(this.tableVul);!(t=(l=i.next()).done);t=!0){var r=l.value,s=!0,n=!1,o=void 0;try{for(var u,c=C()(this.tableThreat);!(s=(u=c.next()).done);s=!0){var d=u.value,h=!1,f=!0,m=!1,b=void 0;try{for(var p,v=C()(d.tv);!(f=(p=v.next()).done);f=!0){var y=p.value;if(y===r.vulnerability){h=!0;break}}}catch(L){m=!0,b=L}finally{try{f||null==v.return||v.return()}finally{if(m)throw b}}if(!0===h){var g=!0,x=!1,k=void 0;try{for(var w,_=C()(this.tableAsset);!(g=(w=_.next()).done);g=!0){var V=w.value;h=!1;var F=!0,T=!1,A=void 0;try{for(var O,S=C()(r.va);!(F=(O=S.next()).done);F=!0){var z=O.value;if(z===V.asset){h=!0;break}}}catch(L){T=!0,A=L}finally{try{F||null==S.return||S.return()}finally{if(T)throw A}}if(!0===h){var R={asset:V.asset,vulnerability:r.vulnerability,threat:d.threat,level:0};if(0===this.method){var W=Math.sqrt((M.indexOf(V.rank)+1)*(M.indexOf(r.rank)+1))*Math.sqrt((M.indexOf(r.rank)+1)*(M.indexOf(d.rank)+1));R.level=this.levelMultiply(W)}else R.level=P[D[M.indexOf(V.rank)][M.indexOf(r.rank)]-1][$[M.indexOf(d.rank)][M.indexOf(r.rank)]-1];this.tva_results.push(R)}}}catch(L){x=!0,k=L}finally{try{g||null==_.return||_.return()}finally{if(x)throw k}}}}}catch(L){n=!0,o=L}finally{try{s||null==c.return||c.return()}finally{if(n)throw o}}}}catch(L){e=!0,a=L}finally{try{t||null==i.return||i.return()}finally{if(e)throw a}}this.resultDialogVisible=!0},submitClick:function(){var t=this,e="相乘法";1===this.method&&(e="矩阵法");var a=[],l=[],i=[],r={tva_results:this.tva_results,tv_results:{},va_results:{}},s=!0,n=!1,o=void 0;try{for(var u,c=C()(this.tableAsset);!(s=(u=c.next()).done);s=!0){var d=u.value,h={assetname:d.asset,val:M.indexOf(d.rank)+1,description:d.details+"&&&"+d.confidentiality+"&&&"+d.integrity+"&&&"+d.availability+"&&&"};a.push(h)}}catch(O){n=!0,o=O}finally{try{s||null==c.return||c.return()}finally{if(n)throw o}}var f=!0,m=!1,b=void 0;try{for(var v,y=C()(this.tableThreat);!(f=(v=y.next()).done);f=!0){var g=v.value;r.tv_results[g.threat]=g.tv;var x={threatname:g.threat,val:M.indexOf(g.rank)+1,description:g.details};l.push(x)}}catch(O){m=!0,b=O}finally{try{f||null==y.return||y.return()}finally{if(m)throw b}}var k=!0,w=!1,_=void 0;try{for(var V,F=C()(this.tableVul);!(k=(V=F.next()).done);k=!0){var T=V.value;r.va_results[T.vulnerability]=T.va;var A={vulname:T.vulnerability,val:M.indexOf(T.rank)+1,description:T.details};i.push(A)}}catch(O){w=!0,_=O}finally{try{k||null==F.return||F.return()}finally{if(w)throw _}}this.$http({method:"POST",url:"/sys/submit",emulateJSON:!0,body:p()({systemname:this.systemname,description:"目标："+this.aim+"&&&范围："+this.range+"&&&成员："+this.team+"&&&",method:e,assets:a,threats:l,vulnerabilities:i,results:r})}).then(function(e){e.ok&&0===e.body.status?t.messageBox("提示","结果已提交至服务器"):t.messageBox("提交错误",e.body.error)},function(e){t.messageBox("提交错误",e.body.error)}),this.resultDialogVisible=!1},createTable:function(t,e,a,l,i,r){var s=new Paragraph(e).title(),n=new Table(a.length+1,l.length);n.setWidth(WidthType.PERCENTAGE,"100%");for(var o=0;o<i.length;++o)n.getCell(0,o).addContent((new Paragraph).center().addRun(new TextRun(i[o]).size(r)));for(var u=0;u<a.length;++u)for(var c=0;c<l.length;++c){var d=new Paragraph;d.addRun(new TextRun(a[u][l[c]]).size(r));var h=n.getCell(u+1,c);h.addContent(d)}t.addParagraph(s),t.addParagraph(n)},createWord:function(){var t=this,e=new Paragraph,a=["asset","vulnerability","threat","level"],l=["资产名称","脆弱性名称","威胁名称","风险等级"],i=["asset","confidentiality","integrity","availability","rank","details"],r=["资产名称","保密性","完整性","可用性","最高安全等级","描述"],s=["vulnerability","vaString","rank","details"],n=["脆弱性名称","资产关联","脆弱性等级","描述"],o=["threat","tvString","rank","details"],u=["威胁名称","脆弱性关联","威胁等级","描述"],c=28,d=32,h=(new Paragraph).addRun(new TextRun("系统名："+this.systemname).size(d)),f=(new Paragraph).addRun(new TextRun("方法："+z[this.method]).size(d)),m=(new Paragraph).addRun(new TextRun("目标："+this.aim).size(d)),b=(new Paragraph).addRun(new TextRun("范围："+this.range).size(d)),p=(new Paragraph).addRun(new TextRun("团队："+this.team).size(d)),v=new Document;v.addParagraph(h),v.addParagraph(f),v.addParagraph(m),v.addParagraph(b),v.addParagraph(p),v.addParagraph(e),this.createTable(v,"资产情况：",this.tableAsset,i,r,c),this.createTable(v,"脆弱性情况：",this.tableVul,s,n,c),this.createTable(v,"威胁情况：",this.tableThreat,o,u,c),v.addParagraph(e),this.createTable(v,"评估结果：",this.tva_results,a,l,c);var y=new Packer;y.toBlob(v).then(function(e){saveAs(e,t.systemname+"评估报告.docx")})},createHist:function(){this.chartDialogVisible=!0,this.$nextTick(function(){var t=a("3eba");a("94b1"),a("007d"),a("627c");var e=t.init(document.getElementById("chart")),l={title:{text:"重要资产的风险值等级柱状图"},tooltip:{},xAxis:{data:[]},yAxis:{},axisLabel:{interval:0,rotate:40},series:[{type:"bar",data:[]}]},i=[],r=[],s=[],n=[],o=0,u=!0,c=!1,d=void 0;try{for(var h,f=C()(this.tableAsset);!(u=(h=f.next()).done);u=!0){var m=h.value;r.push(m.asset);var b=0,p=!0,v=!1,y=void 0;try{for(var g,x=C()(this.tva_results);!(p=(g=x.next()).done);p=!0){var k=g.value;k.asset===m.asset&&(i.push(k.level),n.push(""),++b)}}catch(_){v=!0,y=_}finally{try{p||null==x.return||x.return()}finally{if(v)throw y}}++b,i.push(0),n.push(""),s.push(Math.floor(b/2)+o-1),o+=b}}catch(_){c=!0,d=_}finally{try{u||null==f.return||f.return()}finally{if(c)throw d}}for(var w=0;w<r.length;++w)n[s[w]]=r[w];l.xAxis.data=n,l.series[0].data=i,e.setOption(l)})}}},W=R,L=(a("0f1a"),a("e099"),Object(s["a"])(W,A,O,!1,null,"0e8bff49",null)),E=L.exports;l["default"].use(h["a"]);var j=new h["a"]({routes:[{path:"/",name:"login",component:x},{path:"/mainPage",name:"mainPage",component:T},{path:"/new",name:"new",component:E}]}),B=a("28dd");l["default"].use(B["a"]),l["default"].config.productionTip=!1,new l["default"]({router:j,render:function(t){return t(u)}}).$mount("#app")},"570d":function(t,e,a){"use strict";var l=a("2aaf"),i=a.n(l);i.a},"64a9":function(t,e,a){},8516:function(t,e,a){},9908:function(t,e,a){},be89:function(t,e,a){},e099:function(t,e,a){"use strict";var l=a("9908"),i=a.n(l);i.a}});
//# sourceMappingURL=app.c7a4de56.js.map